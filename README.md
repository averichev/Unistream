# Тестовое задание T4 (C#)

---

## Задание

Дан интерфейс, описывающий финансовую транзакцию:

```csharp
public interface ITransaction 
{ 
    Guid Id { get; } 
    Guid ClientId { get; } 
    DateTime DateTime { get; } 
    decimal Amount { get; } 
}
```

Создайте реализации этого интерфейса:

- `CreditTransaction` — зачисление средств клиенту
- `DebitTransaction` — списание средств у клиента

Необходимо написать **Web API**, которое позволяет:

1. Зачислять средства клиенту
2. Списывать средства клиента
3. Отменять указанную транзакцию
4. Получать актуальный баланс клиента

---

## Эндпоинты

### `POST /credit`

**Request:**

```json
{
    "id": "8f0452b2-867b-4ef8-9a9d-3c9c03d9afdf",
    "clientId": "cfaa0d3f-7fea-4423-9f69-ebff826e2f89",
    "dateTime": "2019-04-02T13:10:20.0263632+03:00",
    "amount": 23.05
}
```

**Response 200 OK:**

```json
{
    "insertDateTime": "2024-10-25T12:03:34+05:00",
    "clientBalance": 23.05
}
```

---

### `POST /debit`

**Request:**

```json
{
    "id": "05eb235c-4955-4c16-bcdd-34e8178228de",
    "clientId": "cfaa0d3f-7fea-4423-9f69-ebff826e2f89",
    "dateTime": "2019-04-02T13:10:25.0263632+03:00",
    "amount": 23.05
}
```

**Response 200 OK:**

```json
{
    "insertDateTime": "2024-10-25T12:03:34+05:00",
    "clientBalance": 0
}
```

---

### `POST /revert?id=05eb235c-4955-4c16-bcdd-34e8178228de`

**Response 200 OK:**

```json
{
    "revertDateTime": "2024-10-25T12:03:34+05:00",
    "clientBalance": 23.05
}
```

---

### `GET /balance?id=cfaa0d3f-7fea-4423-9f69-ebff826e2f89`

**Response 200 OK:**

```json
{
    "balanceDateTime": "2024-10-25T12:03:34+05:00",
    "clientBalance": 23.05
}
```

---

## Требования

- Методы **POST должны быть идемпотентными** — при повторной отправке запроса с тем же `Id` должен возвращаться тот же результат, что и ранее.
- Реализовать **валидацию**:
    - сумма (`amount`) всегда положительная;
    - дата не может быть в будущем;
    - нельзя списывать больше, чем есть на балансе.
- Обработка ошибок — в соответствии с **RFC 9457**.
- **Хранение данных:** в реляционной СУБД (предпочтительно **PostgreSQL** или **SQL Server**).
- Сервис **не должен зависеть от одного инстанса** — допускается запуск нескольких экземпляров одновременно.
- **Логирование** — на усмотрение разработчика.
- **Дополнительная функциональность** — по желанию.
- Приветствуется использование **docker-compose** для быстрого запуска.  
